<html>

<head>
    <style>
        body {
            background-color: rgb(16, 8, 32);
        }

        .box {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .box div {
            width: 640px;
            height: 480px;
        }
    </style>
</head>

<body>
    <div class="box">
        <canvas id="map" width="640" height="480">
        </canvas>
    </div>

    <script>
        let canvas = document.getElementById("map");
        let context = canvas.getContext("2d");

        let maps = { "school-front.tmx": { "width": 60, "height": 30, "tilewidth": 32, "tileheight": 32, "layers": [{ "name": "tile", "width": 60, "height": 30, "visible": true, "data": [365, 365, 365, 365, 365, 366, 314, 329, 314, 314, 314, 349, 350, 314, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 314, 314, 314, 330, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 337, 338, 314, 314, 314, 314, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 314, 294, 314, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 349, 350, 314, 314, 337, 338, 13, 14, 14, 13, 14, 14, 14, 14, 14, 14, 13, 14, 14, 13, 14, 14, 14, 14, 13, 14, 14, 13, 14, 14, 14, 14, 14, 14, 13, 14, 14, 13, 314, 314, 314, 314, 314, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 314, 349, 350, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 314, 314, 314, 314, 314, 314, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 314, 330, 314, 314, 301, 13, 14, 14, 13, 14, 14, 14, 14, 14, 14, 13, 14, 14, 13, 13, 269, 270, 13, 13, 14, 14, 13, 14, 14, 14, 14, 14, 14, 13, 14, 14, 13, 303, 314, 314, 314, 314, 314, 314, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 314, 313, 277, 277, 278, 277, 277, 278, 291, 277, 278, 277, 277, 278, 277, 277, 278, 289, 290, 278, 277, 277, 278, 277, 277, 278, 277, 277, 278, 277, 277, 278, 277, 277, 315, 314, 314, 314, 352, 354, 314, 330, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 337, 338, 314, 314, 313, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 330, 352, 362, 366, 314, 314, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 365, 365, 375, 378, 314, 349, 350, 314, 314, 313, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 315, 314, 314, 364, 365, 363, 354, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 375, 378, 314, 314, 314, 314, 314, 314, 313, 314, 314, 337, 338, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 315, 314, 352, 362, 365, 365, 366, 314, 314, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 366, 314, 337, 338, 314, 314, 314, 314, 313, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 364, 365, 365, 365, 366, 314, 314, 314, 352, 362, 365, 365, 365, 365, 365, 365, 365, 366, 314, 349, 350, 314, 314, 314, 314, 313, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 364, 365, 365, 375, 378, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 366, 330, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 294, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 315, 314, 376, 374, 365, 366, 330, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 314, 337, 338, 314, 314, 313, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 315, 314, 314, 364, 375, 378, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 349, 350, 314, 314, 313, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 314, 376, 378, 314, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 314, 314, 313, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 314, 314, 314, 314, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 329, 314, 313, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 337, 338, 314, 315, 314, 314, 314, 314, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 375, 378, 314, 337, 338, 314, 314, 314, 313, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 315, 314, 314, 330, 314, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 349, 350, 314, 314, 314, 313, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 314, 314, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 315, 314, 314, 314, 352, 353, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 314, 337, 338, 314, 325, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 304, 314, 314, 314, 314, 305, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 326, 327, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 375, 378, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 315, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 315, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 375, 378, 314, 314, 330, 314, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 315, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 330, 314, 364, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 337, 338, 314, 314, 314, 330, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 314, 313, 314, 314, 314, 314, 315, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 376, 374, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 349, 350, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 337, 338, 314, 314, 349, 350, 314, 314, 314, 313, 314, 314, 314, 314, 315, 314, 314, 314, 314, 294, 314, 314, 314, 314, 314, 314, 314, 314, 352, 353, 362, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 375, 378, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 330, 314, 349, 350, 314, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 315, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 330, 314, 314, 314, 337, 338, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 313, 314, 314, 314, 314, 315, 349, 350, 314, 314, 314, 314, 314, 330, 314, 314, 352, 353, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 363, 354, 314, 314, 314, 314, 349, 350, 314, 294, 314, 337, 338, 314, 314, 314, 314, 314, 314, 337, 338, 314, 314, 313, 314, 201, 314, 314, 315, 314, 314, 314, 314, 314, 314, 314, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 314, 314, 314, 314, 349, 350, 314, 314, 313, 314, 3, 200, 314, 315, 314, 314, 314, 314, 314, 314, 352, 353, 353, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 366, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 337, 338, 330, 314, 314, 314, 314, 314, 313, 199, 3, 3, 200, 315, 314, 337, 338, 314, 314, 352, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365] }, { "name": "obstruction", "width": 60, "height": 30, "visible": false, "data": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 39, 39, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 39, 39, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 0, 0, 0, 0, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] }], "links": [{ "link": "front-door", "map": "school-hall.tmx", "name": "front-door", "x": 928, "y": 160, "width": 64, "height": 32 }], "music": "outside.mp3" }, "school-hall.tmx": { "width": 30, "height": 18, "tilewidth": 32, "tileheight": 32, "layers": [{ "name": "tile", "width": 30, "height": 18, "visible": true, "data": [106, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 116, 144, 13, 49, 49, 49, 13, 267, 13, 49, 49, 49, 49, 49, 49, 13, 13, 49, 49, 49, 49, 49, 49, 13, 267, 13, 49, 49, 49, 13, 130, 144, 26, 61, 61, 61, 26, 279, 26, 61, 73, 61, 61, 61, 61, 26, 26, 61, 61, 61, 61, 61, 61, 26, 279, 26, 61, 61, 73, 26, 130, 144, 38, 38, 38, 38, 38, 38, 38, 38, 98, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 169, 181, 38, 38, 125, 98, 38, 130, 104, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 168, 38, 38, 38, 38, 38, 38, 166, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 103, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 106, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 177, 38, 38, 38, 38, 38, 38, 178, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 116, 144, 13, 13, 13, 13, 13, 268, 13, 13, 13, 13, 13, 38, 38, 38, 38, 38, 38, 13, 13, 13, 13, 13, 268, 13, 13, 13, 13, 13, 130, 144, 26, 26, 26, 26, 26, 280, 26, 26, 26, 26, 26, 38, 38, 38, 38, 38, 38, 26, 26, 26, 26, 26, 280, 26, 26, 26, 26, 26, 130, 144, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 130, 104, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 168, 38, 38, 38, 38, 38, 38, 166, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 103, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 104, 140, 140, 140, 140, 140, 140, 103, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2] }, { "name": "obstruction", "width": 30, "height": 18, "visible": false, "data": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 365, 365, 365, 0, 0, 0, 365, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 365, 365, 0, 0, 0, 365, 365, 365, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] }], "links": [{ "link": "east-link", "map": "school-gym.tmx", "name": "west-link", "x": 32, "y": 416, "width": 32, "height": 64 }, { "link": "front-door", "map": "school-front.tmx", "name": "front-door", "x": 384, "y": 512, "width": 192, "height": 32 }, { "link": "office-door", "map": "school-office.tmx", "name": "office-door", "x": 192, "y": 64, "width": 32, "height": 32 }], "music": "school.mp3" }, "school-janitor.tmx": { "width": 7, "height": 7, "tilewidth": 32, "tileheight": 32, "layers": [{ "name": "tile", "width": 7, "height": 7, "visible": true, "data": [106, 154, 154, 154, 154, 154, 116, 144, 13, 49, 13, 135, 13, 130, 144, 171, 61, 26, 136, 26, 130, 144, 125, 38, 38, 38, 38, 130, 144, 38, 38, 38, 38, 183, 130, 104, 140, 168, 38, 166, 140, 103, 2, 2, 104, 140, 103, 2, 2] }, { "name": "obstruction", "width": 7, "height": 7, "visible": false, "data": [365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 365, 365, 365, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 365, 365, 365, 365, 365, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365] }], "links": [{ "link": "Janitor Door", "map": "school-gym.tmx", "name": "Janitor Door", "x": 96, "y": 160, "width": 32, "height": 32 }], "music": "school.mp3" }, "school-office.tmx": { "width": 16, "height": 16, "tilewidth": 32, "tileheight": 32, "layers": [{ "name": "tile", "width": 16, "height": 16, "visible": true, "data": [106, 154, 154, 154, 154, 120, 154, 154, 154, 120, 154, 154, 154, 154, 154, 116, 144, 13, 13, 40, 13, 188, 13, 13, 13, 188, 13, 172, 13, 13, 13, 130, 144, 75, 26, 77, 171, 13, 26, 26, 26, 13, 26, 184, 26, 89, 26, 130, 144, 38, 38, 17, 38, 26, 38, 38, 38, 26, 38, 38, 38, 38, 38, 130, 144, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 130, 144, 125, 38, 38, 38, 180, 38, 38, 38, 180, 38, 17, 17, 38, 38, 130, 108, 165, 165, 165, 165, 129, 189, 38, 187, 163, 165, 165, 165, 165, 165, 117, 144, 13, 13, 40, 13, 188, 13, 38, 13, 13, 13, 13, 13, 13, 13, 130, 144, 75, 26, 53, 26, 13, 26, 38, 26, 26, 26, 26, 75, 75, 26, 130, 144, 38, 38, 17, 38, 26, 38, 38, 38, 38, 38, 29, 38, 38, 38, 130, 144, 38, 38, 38, 38, 38, 38, 38, 38, 183, 183, 183, 183, 183, 183, 130, 144, 38, 38, 38, 38, 180, 38, 38, 38, 38, 38, 38, 38, 38, 38, 130, 104, 140, 140, 140, 140, 152, 38, 38, 38, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 144, 38, 38, 38, 38, 38, 38, 38, 38, 38, 130, 2, 2, 2, 2, 2, 104, 140, 168, 38, 166, 140, 140, 140, 140, 140, 103, 2, 2, 2, 2, 2, 2, 2, 104, 140, 103, 2, 2, 2, 2, 2, 2] }, { "name": "obstruction", "width": 16, "height": 16, "visible": true, "data": [314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 0, 314, 314, 314, 0, 0, 0, 314, 0, 314, 0, 314, 0, 314, 314, 0, 0, 314, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 314, 314, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 314, 314, 314, 0, 0, 0, 314, 0, 0, 0, 314, 0, 314, 314, 0, 0, 314, 314, 314, 314, 314, 314, 314, 314, 0, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 0, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 0, 314, 0, 314, 0, 0, 0, 0, 0, 0, 314, 314, 0, 314, 314, 0, 0, 314, 0, 0, 0, 0, 0, 0, 0, 314, 0, 0, 0, 314, 314, 0, 0, 0, 0, 0, 0, 0, 0, 314, 314, 314, 314, 314, 314, 314, 314, 0, 0, 0, 0, 314, 0, 0, 0, 0, 0, 0, 0, 0, 0, 314, 314, 314, 314, 314, 314, 314, 0, 0, 0, 0, 0, 0, 0, 0, 0, 314, 314, 314, 314, 314, 314, 314, 0, 0, 0, 0, 0, 0, 0, 0, 0, 314, 314, 314, 314, 314, 314, 314, 314, 314, 0, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 314] }], "links": [{ "link": "office-door", "map": "school-hall.tmx", "name": "office-door", "x": 256, "y": 448, "width": 32, "height": 32 }], "music": "school.mp3" }, "school-gym.tmx": { "width": 41, "height": 20, "tilewidth": 32, "tileheight": 32, "layers": [{ "name": "tile", "width": 41, "height": 20, "visible": true, "data": [106, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 116, 144, 13, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 14, 13, 14, 14, 13, 130, 144, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 144, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 130, 104, 140, 140, 140, 140, 140, 168, 39, 39, 166, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 168, 39, 39, 166, 140, 140, 140, 140, 140, 103, 2, 2, 2, 2, 2, 2, 144, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 144, 38, 38, 130, 2, 2, 2, 2, 2, 2, 2, 2, 106, 154, 154, 154, 177, 38, 38, 178, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 154, 177, 38, 38, 178, 154, 154, 154, 154, 154, 116, 2, 2, 144, 13, 49, 49, 13, 38, 38, 13, 49, 49, 49, 49, 13, 267, 13, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 13, 38, 38, 13, 13, 49, 49, 13, 13, 130, 2, 2, 144, 171, 61, 61, 26, 38, 38, 26, 61, 61, 61, 61, 171, 279, 26, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 26, 38, 38, 26, 171, 61, 61, 26, 26, 130, 2, 2, 144, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 130, 2, 2, 104, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 103] }, { "name": "obstruction", "width": 41, "height": 20, "visible": false, "data": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 0, 0, 365, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 0, 0, 0, 0, 365, 365, 365, 365, 365, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 0, 0, 0, 0, 365, 365, 365, 0, 0, 365, 0, 0, 365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 365, 0, 0, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365, 365] }], "links": [{ "link": "west-link", "map": "school-hall.tmx", "name": "east-link", "x": 1248, "y": 544, "width": 32, "height": 64 }, { "link": "Janitor Door", "map": "school-janitor.tmx", "name": "Janitor Door", "x": 480, "y": 544, "width": 32, "height": 32 }], "music": "school.mp3" } };

        let map = maps["school-front.tmx"];

        let music = new Audio();

        music.oncanplaythrough = function () {
            console.log("loaded music", music.src);
            music.loop = true;
            music.play();
        }

        music.src = `music/${map.music}`;

        let player = { tileX: 15, tileY: 9, x: 32 * 15, y: 32 * 9, width: 32, height: 32 };
        let camera = { x: player.x, y: player.y };

        let tileset = new Image();
        // or, keep link to source image used?
        let tiles = [null];

        function updateCoord(x, tx) {
            if (Math.abs(x - tx) < 4) {
                return tx;
            }

            if (x < tx) {
                return x + 4;
            } else {
                return x - 4;
            }
        }

        function getLinkById(map, name) {
            for (const link of map.links) {
                if (name == link.name) {
                    return link;
                }
            }

            return null;
        }

        function intersects(a, b) {
            return (a.x >= b.x) && (a.x <= b.x + b.width) &&
                (a.y >= b.y) && (a.y <= b.y + b.height);
        }

        let canChangeMap = true;

        function isMoving(obj) {
            return (obj.x != 32 * obj.tileX) || (obj.y != 32 * obj.tileY);
        }

        function checkLinks() {
            for (const link of map.links) {
                if (intersects(player, link)) {
                    return link;
                }
            }

            return null;
        }

        function changeMusic(src) {
            if (music.src != src) {
                music.src = src;
            }
        }

        function changeMap(mapName, linkName) {
            console.log(`changing map ${mapName} at ${linkName}`);

            let targetMap = maps[mapName];

            if (!targetMap) {
                console.log(`error: map not found ${mapName}`);
                return false;
            }

            let targetLink = getLinkById(targetMap, linkName);

            if (!targetLink) {
                console.log(`error: link not found ${linkName}`);
                return false;
            }

            map = targetMap;

            let linkMidX = targetLink.x + targetLink.width / 2;
            let linkMidY = targetLink.y + targetLink.height / 2;

            player.tileX = Math.floor(linkMidX / 32);
            player.tileY = Math.floor(linkMidY / 32);
            player.x = 32 * player.tileX;
            player.y = 32 * player.tileY;

            changeMusic(`music/${map.music}`);

            return true;
        }

        // how to clean up a whole bunch of these globals as interacting services.
        function updateGame() {
            const link = checkLinks();

            if (link) {
                if (canChangeMap) {
                    canChangeMap = false;
                    changeMap(link.map, link.link);
                }
            } else {
                canChangeMap = true;
            }

            player.x = updateCoord(player.x, 32 * player.tileX);
            player.y = updateCoord(player.y, 32 * player.tileY);

            camera.x = player.x - 16;
            camera.y = player.y - 16;

            drawMap();
        }

        function drawMap() {
            context.fillRect(0, 0, canvas.width, canvas.height);
            context.save();

            const viewLeft = camera.x - canvas.width / 2;
            const viewRight = camera.x + canvas.width / 2;
            const viewTop = camera.y - canvas.height / 2;
            const viewBottom = camera.y + canvas.height / 2;

            const tileLeft = Math.floor(viewLeft / 32);
            const tileRight = Math.ceil(viewRight / 32);
            const tileTop = Math.floor(viewTop / 32);
            const tileBottom = Math.ceil(viewBottom / 32);

            context.translate(-viewLeft, -viewTop);

            for (const layer of map.layers) {
                if (!layer.visible) {
                    continue;
                }

                const left = Math.max(tileLeft, 0);
                const right = Math.min(tileRight, layer.width);
                const top = Math.max(tileTop, 0);
                const bottom = Math.min(tileBottom, layer.height);

                for (let row = top; row < bottom; row++) {
                    for (let col = left; col < right; col++) {
                        let tile = tiles[layer.data[layer.width * row + col]];
                        context.drawImage(tileset, tile.x, tile.y, 32, 32, 32 * col, 32 * row, 32, 32);
                    }
                }
            }

            for (const link of map.links) {
                context.fillStyle = "rgba(255, 0, 255, 0.2)";
                context.fillRect(link.x, link.y, link.width, link.height);
            }

            context.fillStyle = "rgb(32, 32, 32)";
            context.fillRect(32 * player.tileX, 32 * player.tileY, 32, 32);

            context.fillStyle = "rgb(0, 0, 0)";
            context.fillRect(player.x, player.y, 32, 32);

            context.restore();
        }

        let keymap = {
            "w": function (e) { if (!isMoving(player)) { player.tileY -= 1; } },
            "s": function (e) { if (!isMoving(player)) { player.tileY += 1; } },
            "a": function (e) { if (!isMoving(player)) { player.tileX -= 1; } },
            "d": function (e) { if (!isMoving(player)) { player.tileX += 1; } },
        };

        window.onkeypress = function (e) {
            const handler = keymap[e.key];

            if (handler) {
                handler(e);
            }
        }

        tileset.onload = function () {
            // tile convention is to start from 1
            tiles = [null];

            // build location index
            for (let y = 0; y < tileset.height; y += 32) {
                for (let x = 0; x < tileset.width; x += 32) {
                    tiles.push({ x: x, y: y });
                }
            }

            setInterval(updateGame, 1000 / 60);
        }

        tileset.src = "tileset/tileset1.png";
    </script>
</body>

</html>